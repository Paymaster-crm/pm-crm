"use strict";(self.webpackChunkpaymaster_crm=self.webpackChunkpaymaster_crm||[]).push([[4193,3557],{3557:(e,a,o)=>{o.r(a),o.d(a,{default:()=>c});var s=o(9950),r=o(9254),t=o(226),n=o(4414);const i=s.lazy((()=>o.e(5569).then(o.bind(o,5569)))),l=(0,r.Ay)(t.A)({backgroundColor:"#111b21",color:"#fff",padding:"8px 20px",cursor:"pointer",boxShadow:"0 0 20px 1px rgba(0, 0, 0, 0.3)",borderRadius:"8px",marginTop:"10px",textTransform:"none",fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),"&:hover":{backgroundColor:"#111b21",boxShadow:"0 0 20px 1px rgba(0, 0, 0, 0.3)"}});function d(e){return(0,n.jsx)(l,{startIcon:e.isSubmitting?(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(i,{style:{margin:0,width:20,height:20,marginRight:10,color:"#fff"}}),children:(0,n.jsx)(i,{style:{margin:0,width:20,height:20,marginRight:10,color:"#fff"}})}):null,type:"submit",disableRipple:!0,variant:"contained",disabled:e.isSubmitting,children:e.name})}const c=s.memo(d)},4193:(e,a,o)=>{o.r(a),o.d(a,{default:()=>g});var s=o(9950),r=o(9246),t=o(3939),n=o(2436),i=o(9714);const l=(e,a)=>i.Ik({password:a?i.Yj().notRequired():i.Yj().required("Password is required"),twoFAToken:e&&!a?i.Yj().required("2FA token is required"):i.Yj().notRequired(),backupCode:a?i.Yj().required("Backup code is required").length(8,"Backup code must be exactly 8 characters long"):i.Yj().notRequired()});var d=o(4019),c=o(1118),u=o(2986),p=o(3557),h=o(4414);function m(e){const{setUser:a}=(0,s.useContext)(n.R),[o,i]=(0,s.useState)(!1),m=(0,s.useRef)(null),g=(0,t.Wx)({initialValues:{username:e.username,password:"",twoFAToken:"",backupCode:""},validationSchema:l(e.isTwoFactorEnabled,o),onSubmit:async s=>{const t=await(0,u.N)();try{const n=await r.A.post("https://sameer-yadav.online/api/login",{username:s.username,password:s.password,twoFAToken:o?"":s.twoFAToken,backupCode:o?s.backupCode:"",userAgent:navigator.userAgent,geolocation:t,isTwoFactorEnabled:e.isTwoFactorEnabled,useBackupCode:o},{withCredentials:!0});"Login successful"===n.data.message?a(n.data.user):(alert(n.data.message),g.setFieldValue("twoFAToken",""),g.setFieldValue("backupCode",""))}catch(n){console.error(n),alert(n.response.data.message)}}});return(0,s.useEffect)((()=>{var e;null===(e=m.current)||void 0===e||e.focus()}),[]),(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("form",{className:"login-form",onSubmit:g.handleSubmit,children:[!o&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c._,{ref:m,toggleMask:!0,id:"password",name:"password",placeholder:"Password",value:g.values.password,onChange:g.handleChange,feedback:!1,className:g.touched.password&&g.errors.password?"p-invalid":""}),g.touched.password&&g.errors.password&&(0,h.jsx)("small",{className:"p-error",children:g.errors.password})]}),e.isTwoFactorEnabled&&(0,h.jsxs)("div",{children:[o?(0,h.jsx)("span",{children:"Enter Backup Code"}):(0,h.jsx)("span",{children:"Enter Google Authenticator token"}),!o&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(d.o,{placeholder:"Enter 6-digit code",value:g.values.twoFAToken,onChange:e=>g.setFieldValue("twoFAToken",e.value),mask:!0,integerOnly:!0,length:6}),g.touched.twoFAToken&&g.errors.twoFAToken&&(0,h.jsx)("small",{className:"p-error",children:g.errors.twoFAToken})]}),o&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(d.o,{placeholder:"Enter Backup Code",value:g.values.backupCode,onChange:e=>g.setFieldValue("backupCode",e.value),mask:!0,length:8}),g.touched.backupCode&&g.errors.backupCode&&(0,h.jsx)("small",{className:"p-error",children:g.errors.backupCode})]}),(0,h.jsx)("span",{onClick:()=>i(!o),style:{cursor:"pointer",color:"#0060ae",fontWeight:"bold",marginTop:"16px"},children:o?"Use Google Authenticator":"Use Backup Code"})]}),(0,h.jsx)("div",{style:{marginTop:16},children:(0,h.jsx)(p.default,{isSubmitting:g.isSubmitting,name:"Login"})})]})})}const g=s.memo(m)},2986:(e,a,o)=>{o.d(a,{N:()=>s});const s=async()=>{try{const e=await fetch("https://api.ipify.org?format=json"),a=(await e.json()).ip,o=await fetch(`https://ipapi.co/${a}/json/`),s=await o.json();return{latitude:s.latitude,longitude:s.longitude,ipAddress:a}}catch(e){console.error("Error fetching data:",e)}}}}]);